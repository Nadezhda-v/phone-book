!function(){"use strict";var e={d:function(t,n){for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{renderContacts:function(){return l},renderPhoneBook:function(){return d}});const n=e=>JSON.parse(localStorage.getItem(e))||[],o=e=>{localStorage.setItem("contacts",JSON.stringify(e))},a=(e,t)=>{const a=n("contacts"),c=a.findIndex((t=>t.phone===e));-1!==c&&(a[c].name=t.querySelector(".cell-name").textContent,a[c].surname=t.querySelector(".cell-surname").textContent,a[c].phone=t.querySelector(".cell-phone a").textContent,o(a))},c=()=>{const e=document.createElement("div");return e.classList.add("container"),e},s=e=>{const t=document.createElement("div");t.classList.add("btn-wrapper");const n=e.map((e=>{let{className:t,type:n,text:o}=e;const a=document.createElement("button");return a.className=t,a.type=n,a.textContent=o,a}));return t.append(...n),{btnWrapper:t,buttons:n}},r=e=>{let{name:t,surname:n,phone:o}=e;const a=document.createElement("tr");a.classList.add("contact");const c=document.createElement("td");c.classList.add("delete");const r=document.createElement("button");r.classList.add("del-icon"),c.append(r);const l=document.createElement("td");l.classList.add("cell-name"),l.textContent=t;const d=document.createElement("td");d.classList.add("cell-surname"),d.textContent=n;const i=document.createElement("td");i.classList.add("cell-phone");const u=document.createElement("a");u.classList.add("d-block"),u.href=`${o}`,u.textContent=o;const m=document.createElement("td");a.phoneLink=u;const p=s([{className:"btn btn-primary button-edit",type:"button",text:"Редактировать"}]);return m.append(...p.buttons),i.append(u),a.append(c,l,d,i,m),a},l=(e,t)=>{const n=t.map(r);e.append(...n)},d=(e,t)=>{const n=(()=>{const e=document.createElement("header");e.classList.add("header");const t=c();return e.append(t),e.headerContainer=t,e})(),o=(e=>{const t=document.createElement("h1");return t.classList.add("logo"),t.textContent=`Телефонный справочник ${e}`,t})(t),a=(()=>{const e=document.createElement("main"),t=c();return e.append(t),e.mainContainer=t,e})(),r=s([{className:"btn btn-primary mr-3 btn-add",type:"button",text:"Добавить"},{className:"btn btn-danger",type:"button",text:"Удалить"}]),l=(()=>{const e=document.createElement("table");e.classList.add("table","table-striped");const t=document.createElement("thead");t.insertAdjacentHTML("beforeend",'\n    <tr>\n      <th class=\'delete\'>Удалить</th>\n      <th class="col-3 th-cell cell-name">Имя</th>\n      <th class="col-3 th-cell cell-surname">Фамилия</th>\n      <th class="col-3">Телефон</th>\n      <th class="col-3">Действия</th>\n    </tr>\n  ');const n=document.createElement("tbody");return e.append(t,n),e.tbody=n,e.thead=t,e})(),{form:d,overlay:i}=(()=>{const e=document.createElement("div");e.classList.add("form-overlay");const t=document.createElement("form");t.classList.add("form"),t.insertAdjacentHTML("beforeend",'\n    <button class="close" type="button"></button>\n    <h2 class="form-title">Добавить контакт</h2>\n\n    <div class="form-group">\n      <label class="form-label" for="name">Имя:</label>\n      <input class="form-input" name="name" \n        id="name" type="text" maxlength="15" required>\n    </div>\n\n    <div class="form-group">\n      <label class="form-label" for="surname">Фамилия:</label>\n      <input class="form-input" name="surname" \n        id="surname" type="text" maxlength="15" required>\n    </div>\n\n    <div class="form-group">\n      <label class="form-label" for="phone">Телефон:</label>\n      <input class="form-input" name="phone" \n        id="phone" type="text" required>\n    </div>\n  ');const n=s([{className:"btn btn-primary mr-3",type:"submit",text:"Добавить"},{className:"btn btn-danger",type:"reset",text:"Отмена"}]);return e.append(t),t.append(...n.buttons),{overlay:e,form:t}})(),u=(e=>{const t=document.createElement("footer");t.classList.add("footer");const n=c(),o=document.createElement("span");return o.textContent=`Все права защищены ©${e}`,t.append(n),n.append(o),t})(t);return e.append(n,a,u),n.headerContainer.append(o),a.mainContainer.append(r.btnWrapper,l,i),{list:l.tbody,logo:o,buttonAdd:r.buttons[0],formOverlay:i,form:d,buttonDel:r.buttons[1],headerList:l.thead}},i=e=>/^[а-яА-ЯёЁ]+$/.test(e),u=(e,t)=>{const n=t.textContent;e.forEach((e=>{e.addEventListener("mouseenter",(()=>{t.textContent=e.phoneLink.textContent})),e.addEventListener("mouseleave",(()=>{t.textContent=n}))}))},m=(e,t,n)=>{const o=[];[...t.querySelectorAll(".contact")].forEach((t=>{const n=t.querySelector(e).textContent;o.push({data:n,row:t})}));const a=void 0===n||n;o.sort(((e,t)=>a?e.data.localeCompare(t.data):t.data.localeCompare(e.data)));const c=o.map((e=>e.row));t.innerHTML="",t.append(...c),((e,t)=>{const n={column:e,isAscending:t};localStorage.setItem("sortContacts",JSON.stringify(n))})(e,a)},p=(e,t)=>{const n=e.target;"Backspace"===e.key&&0===n.textContent.length&&e.preventDefault(),n.textContent.length>=t&&"Backspace"!==e.key&&e.preventDefault()};var b={hoverRow:u,sortContacts:m,handleSortContacts:(e,t)=>{let n=!1;e.addEventListener("click",(e=>{const o=e.target.closest("th");if(o.classList.contains("cell-name")||o.classList.contains("cell-surname")){const e="."+o.classList[2];n=!n,m(e,t,n)}}))},modalControl:(e,t)=>{const n=()=>{t.classList.remove("is-visible")};return e.addEventListener("click",(()=>{t.classList.add("is-visible"),(()=>{const e=document.querySelector("#name"),t=document.querySelector("#surname"),n=document.querySelector("#phone");e.addEventListener("input",(()=>{e.value=e.value.replace(/[^а-яА-ЯёЁ]/g,"")})),t.addEventListener("input",(()=>{t.value=t.value.replace(/[^а-яА-ЯёЁ]/g,"")})),n.addEventListener("input",(()=>{let e=n.value.replace(/[^+\d]/g,"");e.includes("+")&&(e=e.replace(/\+/g,""),e=e.replace(e.slice(0,1),7),e="+"+e),e.includes("+")?n.value=e.length>12?e.slice(0,12):e:n.value=e.length>11?e.slice(0,11):e}))})()})),t.addEventListener("click",(e=>{const o=e.target;(o===t||o.closest(".close"))&&n()})),{closeModal:n}},deleateControl:(e,t)=>{e.addEventListener("click",(()=>{document.querySelectorAll(".delete").forEach((e=>{e.classList.toggle("is-visible")}))})),document.addEventListener("click",(n=>{const o=n.target;o.classList.contains("del-icon")||t.contains(o)||e.contains(o)||document.querySelectorAll(".delete").forEach((e=>{e.classList.remove("is-visible")}))})),t.addEventListener("click",(e=>{const t=e.target;if(t.classList.contains("del-icon")){const e=t.closest(".contact"),a=e.querySelector(".cell-phone a").textContent;e.remove(),(e=>{const t=n("contacts"),a=t.findIndex((t=>t.phone===e));t.splice(a,1),o(t)})(a)}}))},formControl:(e,t,a,c)=>{e.addEventListener("submit",(s=>{s.preventDefault();const l=new FormData(s.target);((e,t,a)=>{const c=r(e);t.append(c),u([c],a),(e=>{const t=n("contacts");t.push(e),o(t)})(e)})(Object.fromEntries(l),t,c),e.reset(),a()}))},editContactControl:e=>{e.addEventListener("click",(e=>{e.target.closest(".button-edit")&&(e=>{const t=e.target.closest(".contact"),o=t.querySelector(".cell-phone"),c=t.querySelector(".cell-name"),s=t.querySelector(".cell-surname"),r=t.querySelector(".cell-phone a"),l=c.textContent,d=s.textContent,u=r.textContent;t.classList.add("table-primary"),c.contentEditable=!0,s.contentEditable=!0,o.contentEditable=!0,r.contentEditable=!0,c.addEventListener("keydown",(e=>p(e,15))),s.addEventListener("keydown",(e=>p(e,15))),o.addEventListener("keydown",(e=>p(e,12))),t.prevData={name:l,surname:d,phone:u};const m=e=>{t.contains(e.target)||((e=>{const t=e.querySelector(".cell-phone"),o=e.querySelector(".cell-name"),c=e.querySelector(".cell-surname"),s=e.querySelector(".cell-phone a"),r=o.textContent,l=c.textContent,d=s.textContent;s.setAttribute("href",d);const u=i(r),m=i(l),p=(e=>{if(!/^\+?\d{11}$/.test(e))return!1;const t=n("contacts").findIndex((t=>t.phone===e));return-1===t||(console.log(t),!1)})(d);e.classList.remove("table-primary"),o.contentEditable=!1,c.contentEditable=!1,t.contentEditable=!1,s.contentEditable=!1,p?a(e.prevData.phone,e):(s.textContent=e.prevData.phone,s.setAttribute("href",e.prevData.phone)),u&&m?a(e.prevData.phone,e):(o.textContent=e.prevData.name,c.textContent=e.prevData.surname)})(t),document.removeEventListener("click",m))};document.addEventListener("click",m)})(e)}))}};const{renderPhoneBook:h,renderContacts:v}=t,{modalControl:y,deleateControl:f,formControl:E,sortContacts:L,handleSortContacts:C,hoverRow:g,editContactControl:x}=b;((e,t)=>{const o=document.querySelector("#app"),a=n("contacts"),{column:c,isAscending:s}=JSON.parse(localStorage.getItem("sortContacts"))||{column:"",isAscending:""},{list:r,logo:l,buttonAdd:d,formOverlay:i,buttonDel:u,headerList:m,form:p}=h(o,"Надежда");v(r,a);const{closeModal:b}=y(d,i);f(u,r),E(p,r,b,l),C(m,r),L(c,r,s),g(r.querySelectorAll(".contact"),l),x(r)})()}();